<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Spring 使用笔记之(五) - Spring-ws实现基于契约优先的WebService - 海波的博客</title>

	<link rel="shortcut icon" href="/styles/images/favicon.png">
	<link rel="icon" href="/styles/images/favicon.png">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/styles/css/syntax.css">
	<link rel="canonical" href="/2015/02/27/08-spring-mvc-spring-web-service/">
	<link rel="alternate" type="application/rss+xml" title="海波的博客" href="/feed.xml">

	<meta name="keywords" content="Spring 使用笔记之(五) - Spring-ws实现基于契约优先的WebService, 海波的博客, 葛海波;个人博客;">
	<meta name="description" content="葛海波;个人博客;">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?";
		  var s = document.getElementsByTagName("script")[0];
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>


  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a> -->
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">大类分解</a>
        </li>
        <li>
          <a href="/tag">小类内聚</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <!-- <li>
            <a><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></a>
        </li> -->
        <li>
          <a href="/donate/"><strong>打赏</strong></a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/gehaibo">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="">关于作者</a></li>
            <li><a rel="nofollow" href="/books">我的书单</a></li>
            <li><a rel="nofollow" href="/reference">推荐博客</a></li>
            <!-- <li><a href="/feed.xml">RSS订阅</a></li> -->
            <!-- <li class="divider"></li> -->
            <!-- <li><a rel="nofollow" target="_blank" href="https://github.com/gehaibo/gehaibo.github.com">本项目</a></li> -->
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>Spring 使用笔记之(五) - Spring-ws实现基于契约优先的WebService</h1>
		    <p>Post on Feb 27, 2015 by <a href="/about">ghb</a></p>
		-->
		    <h1>Make it right before you make it faster.</h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#技术文档-ref">技术文档</a>	/
    	<a href="/tag/#Spring-ref">Spring</a>
    
  </div>
</div>

    

    <div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
  <h1>目录</h1>
  <ul class="nav sidenav">
<!--
    
      
      
      
      

      
        <li><a href="#year_2017">2017</a>
          <ul class="nav">
            <li><a href="#month_2017_April">April</a></li>
      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_March">March</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_February">February</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_January">January</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
        
            </ul>
          </li>
          <li><a href="#year_2016">2016</a>
            <ul class="nav">
              <li><a href="#month_2016_December">December</a></li>
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_November">November</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_October">October</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_September">September</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_June">June</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_May">May</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_March">March</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
        
            </ul>
          </li>
          <li><a href="#year_2015">2015</a>
            <ul class="nav">
              <li><a href="#month_2015_March">March</a></li>
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2015_February">February</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2015_January">January</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            </ul>
          </li>
      
    
-->
  </ul>
</div> 
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">Spring 使用笔记之(五) - Spring-ws实现基于契约优先的WebService</h1>
              <!--
                <p class="post-meta">Feb 27, 2015</p>
              -->
              <div class="meta">Posted on <span class="postdate">Feb 27, 2015</span> By <a target="_blank" href="http://localhost:4000">ghb</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#maven依赖" id="markdown-toc-maven依赖">Maven依赖</a></li>
  <li><a href="#demoxsd" id="markdown-toc-demoxsd">demo.xsd</a></li>
  <li><a href="#webxml添加" id="markdown-toc-webxml添加">Web.xml添加</a></li>
  <li><a href="#spring-ws-servletxml" id="markdown-toc-spring-ws-servletxml">spring-ws-servlet.xml</a></li>
  <li><a href="#定义userrequest和userresponse的实体类" id="markdown-toc-定义userrequest和userresponse的实体类">定义UserRequest和UserResponse的实体类</a></li>
  <li><a href="#userendpoint" id="markdown-toc-userendpoint">UserEndpoint</a></li>
  <li><a href="#获得wsdl的详细信息如下" id="markdown-toc-获得wsdl的详细信息如下">获得WSDL的详细信息如下</a></li>
  <li><a href="#使用soap-ui测试结果" id="markdown-toc-使用soap-ui测试结果">使用SOAP-UI测试结果</a></li>
  <li><a href="#参考资料" id="markdown-toc-参考资料">参考资料</a></li>
</ul>

<p>以前写过基于JAXB的传统Java WebService服务端,通过IBM WebSphere Message Broker生成过WebService服务端，最近项目要在Spring MVC搭建的Web项目中添加WebService服务。研究之后发现主流的实现无外乎Apache CXF，Axis 2，Spring WebService。通过对比发现，CXF需要引入的jar依赖太多，Axis 2太重量级，最后选择Spring WebService,主要原因是原有的Web项目是基于Spring MVC的，Spring WebSercice可以与之无缝整合，Spring WebService完全可以支撑现有的业务，并且相对比较轻量级。</p>

<blockquote>
  <p>基于Spring MVC的web项目上可以通过Spring WebService添加Webservice的服务端实现。</p>
</blockquote>

<h1 id="maven依赖">Maven依赖</h1>
<p>需要的jar包可以通过Maven导入</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.springframework.ws<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>spring-ws-core<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>2.2.0.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>jaxen<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>jaxen<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>1.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>wsdl4j<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>wsdl4j<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>1.6.3<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<h1 id="demoxsd">demo.xsd</h1>
<p>因为在我们的WebService服务端当中引入了JAXB2，所以整个服务端Endpoint类编写变的简单，同时Spring-WS2.0支持 将XSD文档自动转换成WSDL，这样我们就不用直接编写复杂的WSDL，而只需要编写好XSD文档即可实现WSDL发布。一般来说，一个 WebService的编写是从定义WSDL开始的，对于我们这里来说，因为我们可以将XSD自动转换成WSDL，所以我们就是从编写简单的XSD开始。</p>
<p />

<p>Spring WebService基于约定优于配置的原则，规定所有的入参在定义XSD时要以Request结尾(<strong><em>Request)，比如我们这里的UserRequest；所有的出站参数要以Response结尾(</em></strong>Response)，比如我们这里的UserResponse。前面的相同***部分标识为同一个Operation，了解这些之后就可以定义们的XSD文档，具体内容如下：</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;schema</span> <span class="na">targetNamespace=</span><span class="s">"http://www.hifreud.com/ws/demo"</span>
	<span class="na">elementFormDefault=</span><span class="s">"qualified"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span>
	<span class="na">xmlns:tns=</span><span class="s">"http://www.hifreud.com/ws/demo"</span><span class="nt">&gt;</span>

	<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"UserResponse"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;complexType&gt;</span>
			<span class="nt">&lt;sequence&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">type=</span><span class="s">"string"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"gender"</span> <span class="na">type=</span><span class="s">"string"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"birthday"</span> <span class="na">type=</span><span class="s">"date"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"location"</span> <span class="na">type=</span><span class="s">"string"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
			<span class="nt">&lt;/sequence&gt;</span>
		<span class="nt">&lt;/complexType&gt;</span>
	<span class="nt">&lt;/element&gt;</span>

	<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"UserRequest"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;complexType&gt;</span>
			<span class="nt">&lt;sequence&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"userId"</span> <span class="na">type=</span><span class="s">"string"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/sequence&gt;</span>
		<span class="nt">&lt;/complexType&gt;</span>
	<span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;/schema&gt;</span></code></pre></figure>

<p>以上定义了一个User的Operation，如参为UserRequest,出参为UserResponse.</p>

<h1 id="webxml添加">Web.xml添加</h1>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;servlet&gt;</span>        
	<span class="nt">&lt;servlet-name&gt;</span>spring-ws<span class="nt">&lt;/servlet-name&gt;</span>         
	<span class="nt">&lt;servlet-class&gt;</span>org.springframework.ws.transport.http.MessageDispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>   
<span class="nt">&lt;servlet-mapping&gt;</span>   
	<span class="nt">&lt;servlet-name&gt;</span>spring-ws<span class="nt">&lt;/servlet-name&gt;</span>   
	<span class="nt">&lt;url-pattern&gt;</span>/webservice/*<span class="nt">&lt;/url-pattern&gt;</span>   
<span class="nt">&lt;/servlet-mapping&gt;</span> </code></pre></figure>

<h1 id="spring-ws-servletxml">spring-ws-servlet.xml</h1>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xmlns:sws=</span><span class="s">"http://www.springframework.org/schema/web-services"</span>
	<span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"</span>
	<span class="err">http://www.springframework.org/schema/beans</span> <span class="err">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span>
	<span class="err">http://www.springframework.org/schema/context</span> <span class="err">http://www.springframework.org/schema/context/spring-context-3.0.xsd</span>
	<span class="err">http://www.springframework.org/schema/web-services</span> <span class="err">http://www.springframework.org/schema/web-services/web-services-2.0.xsd"</span><span class="nt">&gt;</span>
 	<span class="c">&lt;!-- 自动扫描@Endpoint注解 --&gt;</span>
 	<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.freud.endpoint"</span> <span class="nt">/&gt;</span>
	<span class="c">&lt;!-- 开启Spring WebService的注解自动扫描驱动 --&gt;</span>
	<span class="nt">&lt;sws:annotation-driven/&gt;</span>
	<span class="c">&lt;!-- 动态WSDL的配置 --&gt;</span>
	<span class="nt">&lt;sws:dynamic-wsdl</span> <span class="na">id=</span><span class="s">"demo"</span> <span class="na">portTypeName=</span><span class="s">"UserOperation"</span> <span class="na">locationUri=</span><span class="s">"/webservice/demo"</span>
					  <span class="na">targetNamespace=</span><span class="s">"http://www.hifreud.com/ws/demo"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;sws:xsd</span> <span class="na">location=</span><span class="s">"classpath:demo.xsd"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/sws:dynamic-wsdl&gt;</span>
	
<span class="nt">&lt;/beans&gt;</span> </code></pre></figure>

<h1 id="定义userrequest和userresponse的实体类">定义UserRequest和UserResponse的实体类</h1>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">freud</span><span class="o">.</span><span class="na">endpoint</span><span class="o">.</span><span class="na">bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessorType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlElement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlRootElement</span><span class="o">;</span>

<span class="nd">@XmlRootElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"UserRequest"</span><span class="o">)</span>
<span class="nd">@XmlAccessorType</span><span class="o">(</span><span class="n">XmlAccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRequest</span>
<span class="o">{</span>
    <span class="nd">@XmlElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">userId</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUserId</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">userId</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserId</span><span class="o">(</span><span class="n">String</span> <span class="n">userId</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userId</span> <span class="o">=</span> <span class="n">userId</span><span class="o">;</span>
    <span class="o">}</span>
    
<span class="o">}</span></code></pre></figure>

<p><br /></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">freud</span><span class="o">.</span><span class="na">endpoint</span><span class="o">.</span><span class="na">bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessorType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlElement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlRootElement</span><span class="o">;</span>

<span class="nd">@XmlRootElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"UserResponse"</span><span class="o">)</span>
<span class="nd">@XmlAccessorType</span><span class="o">(</span><span class="n">XmlAccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserResponse</span>
<span class="o">{</span>
    <span class="nd">@XmlElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>
    
    <span class="nd">@XmlElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">gender</span><span class="o">;</span>
    
    <span class="nd">@XmlElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthday</span><span class="o">;</span>
    
    <span class="nd">@XmlElement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">location</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUsername</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getGender</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="n">String</span> <span class="n">gender</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getBirthday</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">birthday</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBirthday</span><span class="o">(</span><span class="n">Date</span> <span class="n">birthday</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">birthday</span> <span class="o">=</span> <span class="n">birthday</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getLocation</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">location</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLocation</span><span class="o">(</span><span class="n">String</span> <span class="n">location</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">location</span> <span class="o">=</span> <span class="n">location</span><span class="o">;</span>
    <span class="o">}</span>
    
<span class="o">}</span></code></pre></figure>

<blockquote>
  <p>这两个类非常普通的POJO对象，它们都用到了@XmlRootElement、@XmlAccessorType，这两个annotation由JAXB2提供</p>
</blockquote>

<h1 id="userendpoint">UserEndpoint</h1>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">freud</span><span class="o">.</span><span class="na">endpoint</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.ws.server.endpoint.annotation.Endpoint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ws.server.endpoint.annotation.PayloadRoot</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ws.server.endpoint.annotation.RequestPayload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ws.server.endpoint.annotation.ResponsePayload</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.freud.endpoint.bean.UserRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.freud.endpoint.bean.UserResponse</span><span class="o">;</span>

<span class="nd">@Endpoint</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserEndpoint</span>
<span class="o">{</span>
    <span class="nd">@PayloadRoot</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"http://www.hifreud.com/ws/demo"</span><span class="o">,</span> <span class="n">localPart</span> <span class="o">=</span> <span class="s">"UserRequest"</span><span class="o">)</span>
    <span class="nd">@ResponsePayload</span>
    <span class="kd">public</span> <span class="n">UserResponse</span> <span class="nf">findUserById</span><span class="o">(</span><span class="nd">@RequestPayload</span>
    <span class="n">UserRequest</span> <span class="n">request</span><span class="o">)</span>
        <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="o">{</span>
        
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getUserId</span><span class="o">());</span>
        
        <span class="n">UserResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserResponse</span><span class="o">();</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"Freud"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setGender</span><span class="o">(</span><span class="s">"Male"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setLocation</span><span class="o">(</span><span class="s">"Dalian"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setBirthday</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
        
        <span class="k">return</span> <span class="n">response</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>可以看到，以上的类中采用了四个annotation，在类上的@Endpoint标明将这个类发布成一个Endpoint服务 类，findUserById方法上有两个annotation：@PayloadRoot用于标明findUserById可以授受的XML信息，这里取的是XML的 namespace为<code class="highlighter-rouge">http://www.hifreud.com/ws/demo</code>， 同时XML的ROOT为UserRequest的信息；下面的@ResponsePayload标明findUserById方法有返回值，返回值需要回写给 Webservice调用客户端；参数中还有一个@RequestPayload的annotation，它表示从请求负载中取值作为参数，我们这里因为 采用了JAXB2，所以可以将负载的XML消息直接转换成一个名为UserRequest的Java对象。</p>

<blockquote>
  <p>启动服务。将URL定位到<code class="highlighter-rouge">http://localhost:8080/sws/webservice/demo.wsdl?wsdl</code></p>
</blockquote>

<h1 id="获得wsdl的详细信息如下">获得WSDL的详细信息如下</h1>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span><span class="nt">&lt;wsdl:definitions</span> <span class="na">xmlns:wsdl=</span><span class="s">"http://schemas.xmlsoap.org/wsdl/"</span> <span class="na">xmlns:sch=</span><span class="s">"http://www.hifreud.com/ws/demo"</span> <span class="na">xmlns:soap=</span><span class="s">"http://schemas.xmlsoap.org/wsdl/soap/"</span> <span class="na">xmlns:tns=</span><span class="s">"http://www.hifreud.com/ws/demo"</span> <span class="na">targetNamespace=</span><span class="s">"http://www.hifreud.com/ws/demo"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;wsdl:types&gt;</span>
    <span class="nt">&lt;schema</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">elementFormDefault=</span><span class="s">"qualified"</span> <span class="na">targetNamespace=</span><span class="s">"http://www.hifreud.com/ws/demo"</span><span class="nt">&gt;</span>

	<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"UserResponse"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;complexType&gt;</span>
			<span class="nt">&lt;sequence&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">type=</span><span class="s">"string"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"gender"</span> <span class="na">type=</span><span class="s">"string"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"birthday"</span> <span class="na">type=</span><span class="s">"date"</span><span class="nt">/&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"location"</span> <span class="na">type=</span><span class="s">"string"</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/sequence&gt;</span>
		<span class="nt">&lt;/complexType&gt;</span>
	<span class="nt">&lt;/element&gt;</span>

	<span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"UserRequest"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;complexType&gt;</span>
			<span class="nt">&lt;sequence&gt;</span>
				<span class="nt">&lt;element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"userId"</span> <span class="na">type=</span><span class="s">"string"</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/sequence&gt;</span>
		<span class="nt">&lt;/complexType&gt;</span>
	<span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;/schema&gt;</span>
  <span class="nt">&lt;/wsdl:types&gt;</span>
  <span class="nt">&lt;wsdl:message</span> <span class="na">name=</span><span class="s">"UserResponse"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;wsdl:part</span> <span class="na">element=</span><span class="s">"tns:UserResponse"</span> <span class="na">name=</span><span class="s">"UserResponse"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/wsdl:part&gt;</span>
  <span class="nt">&lt;/wsdl:message&gt;</span>
  <span class="nt">&lt;wsdl:message</span> <span class="na">name=</span><span class="s">"UserRequest"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;wsdl:part</span> <span class="na">element=</span><span class="s">"tns:UserRequest"</span> <span class="na">name=</span><span class="s">"UserRequest"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/wsdl:part&gt;</span>
  <span class="nt">&lt;/wsdl:message&gt;</span>
  <span class="nt">&lt;wsdl:portType</span> <span class="na">name=</span><span class="s">"UserOperation"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;wsdl:operation</span> <span class="na">name=</span><span class="s">"User"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;wsdl:input</span> <span class="na">message=</span><span class="s">"tns:UserRequest"</span> <span class="na">name=</span><span class="s">"UserRequest"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/wsdl:input&gt;</span>
      <span class="nt">&lt;wsdl:output</span> <span class="na">message=</span><span class="s">"tns:UserResponse"</span> <span class="na">name=</span><span class="s">"UserResponse"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/wsdl:output&gt;</span>
    <span class="nt">&lt;/wsdl:operation&gt;</span>
  <span class="nt">&lt;/wsdl:portType&gt;</span>
  <span class="nt">&lt;wsdl:binding</span> <span class="na">name=</span><span class="s">"UserOperationSoap11"</span> <span class="na">type=</span><span class="s">"tns:UserOperation"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;soap:binding</span> <span class="na">style=</span><span class="s">"document"</span> <span class="na">transport=</span><span class="s">"http://schemas.xmlsoap.org/soap/http"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;wsdl:operation</span> <span class="na">name=</span><span class="s">"User"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;soap:operation</span> <span class="na">soapAction=</span><span class="s">""</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;wsdl:input</span> <span class="na">name=</span><span class="s">"UserRequest"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;soap:body</span> <span class="na">use=</span><span class="s">"literal"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/wsdl:input&gt;</span>
      <span class="nt">&lt;wsdl:output</span> <span class="na">name=</span><span class="s">"UserResponse"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;soap:body</span> <span class="na">use=</span><span class="s">"literal"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/wsdl:output&gt;</span>
    <span class="nt">&lt;/wsdl:operation&gt;</span>
  <span class="nt">&lt;/wsdl:binding&gt;</span>
  <span class="nt">&lt;wsdl:service</span> <span class="na">name=</span><span class="s">"UserOperationService"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;wsdl:port</span> <span class="na">binding=</span><span class="s">"tns:UserOperationSoap11"</span> <span class="na">name=</span><span class="s">"UserOperationSoap11"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;soap:address</span> <span class="na">location=</span><span class="s">"/webservice/demo"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/wsdl:port&gt;</span>
  <span class="nt">&lt;/wsdl:service&gt;</span>
<span class="nt">&lt;/wsdl:definitions&gt;</span></code></pre></figure>

<h1 id="使用soap-ui测试结果">使用SOAP-UI测试结果</h1>

<p><img src="/images/blog/spring/08-spring-web-service/01_test_result.png" alt="测试结果" /></p>

<p><br />
<br /></p>

<h1 id="参考资料">参考资料</h1>

<p><a href="http://www.360doc.com/content/13/0121/10/10825198_261510029.shtml">Spring-ws示例WebService开发</a></p>

<p><a href="http://docs.spring.io/spring-ws/docs/2.2.0.RELEASE/reference/htmlsingle/">Spring WebService官方文档(英文)</a></p>

<p><br />
<br /></p>

            </article>
        </div>
      </div>
      <div class="panel docs-content">
        <article class="post-content">
          <div class="wrapper">
             
          </div>
        </article>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2017 <a href=""><code>ghb</code></a>.</p>
		<p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, themed from <a href="http://lesscss.cn/">Less</a></p>
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/lessismore.js"></script>
<script src="/styles/js/application.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  </body>
</html>
