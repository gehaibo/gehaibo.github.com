<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Java NIO系列学习笔记（五） - Selector - 海波的博客</title>

	<link rel="shortcut icon" href="/styles/images/favicon.png">
	<link rel="icon" href="/styles/images/favicon.png">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/styles/css/syntax.css">
	<link rel="canonical" href="/2017/04/18/java-nio-05-selector/">
	<link rel="alternate" type="application/rss+xml" title="海波的博客" href="/feed.xml">

	<meta name="keywords" content="Java NIO系列学习笔记（五） - Selector, 海波的博客, 葛海波;个人博客;">
	<meta name="description" content="葛海波;个人博客;">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?";
		  var s = document.getElementsByTagName("script")[0];
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>


  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <!-- <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a> -->
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">大类分解</a>
        </li>
        <li>
          <a href="/tag">小类内聚</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <!-- <li>
            <a><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></a>
        </li> -->
        <li>
          <a href="/donate/"><strong>打赏</strong></a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/gehaibo">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="">关于作者</a></li>
            <li><a rel="nofollow" href="/books">我的书单</a></li>
            <li><a rel="nofollow" href="/reference">推荐博客</a></li>
            <!-- <li><a href="/feed.xml">RSS订阅</a></li> -->
            <!-- <li class="divider"></li> -->
            <!-- <li><a rel="nofollow" target="_blank" href="https://github.com/gehaibo/gehaibo.github.com">本项目</a></li> -->
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>Java NIO系列学习笔记（五） - Selector</h1>
		    <p>Post on Apr 18, 2017 by <a href="/about">ghb</a></p>
		-->
		    <h1>Make it right before you make it faster.</h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#技术文档-ref">技术文档</a>	/
    	<a href="/tag/#nio-ref">nio</a>
    
  </div>
</div>

    

    <div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
  <h1>目录</h1>
  <ul class="nav sidenav">
<!--
    
      
      
      
      

      
        <li><a href="#year_2017">2017</a>
          <ul class="nav">
            <li><a href="#month_2017_April">April</a></li>
      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_March">March</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_February">February</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_January">January</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
        
            </ul>
          </li>
          <li><a href="#year_2016">2016</a>
            <ul class="nav">
              <li><a href="#month_2016_December">December</a></li>
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_November">November</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_October">October</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_September">September</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_June">June</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_May">May</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_March">March</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
        
            </ul>
          </li>
          <li><a href="#year_2015">2015</a>
            <ul class="nav">
              <li><a href="#month_2015_March">March</a></li>
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2015_February">February</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2015_January">January</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            </ul>
          </li>
      
    
-->
  </ul>
</div> 
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">Java NIO系列学习笔记（五） - Selector</h1>
              <!--
                <p class="post-meta">Apr 18, 2017</p>
              -->
              <div class="meta">Posted on <span class="postdate">Apr 18, 2017</span> By <a target="_blank" href="http://localhost:4000">ghb</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#selector" id="markdown-toc-selector">Selector</a></li>
  <li><a href="#核心类" id="markdown-toc-核心类">核心类</a>    <ul>
      <li><a href="#selector-1" id="markdown-toc-selector-1">Selector</a></li>
      <li><a href="#selectablechannel" id="markdown-toc-selectablechannel">SelectableChannel</a></li>
      <li><a href="#selectionkey" id="markdown-toc-selectionkey">SelectionKey</a></li>
    </ul>
  </li>
  <li><a href="#使用方法" id="markdown-toc-使用方法">使用方法</a>    <ul>
      <li><a href="#创建selector" id="markdown-toc-创建selector">创建Selector</a></li>
      <li><a href="#向selector注册通道" id="markdown-toc-向selector注册通道">向Selector注册通道</a></li>
      <li><a href="#选择通道" id="markdown-toc-选择通道">选择通道</a></li>
      <li><a href="#唤醒selector" id="markdown-toc-唤醒selector">唤醒Selector</a></li>
      <li><a href="#关闭selector" id="markdown-toc-关闭selector">关闭Selector</a></li>
    </ul>
  </li>
  <li><a href="#example" id="markdown-toc-example">Example</a>    <ul>
      <li><a href="#selectorservertest" id="markdown-toc-selectorservertest">SelectorServerTest</a></li>
      <li><a href="#selectorclienttest" id="markdown-toc-selectorclienttest">SelectorClientTest</a></li>
      <li><a href="#server端测试输出" id="markdown-toc-server端测试输出">Server端测试输出</a></li>
      <li><a href="#client端测试输入与输出" id="markdown-toc-client端测试输入与输出">Client端测试输入与输出</a></li>
    </ul>
  </li>
  <li><a href="#参考资料" id="markdown-toc-参考资料">参考资料</a></li>
</ul>

<h1 id="selector">Selector</h1>

<p>Selector是Java NIO中能够通过单线程管理多个NIO通道的组件，而在单线程下实现这个操作就必须需要异步才能实现。</p>

<p>在非NIO模式下，即jdk1.4之前的IO阻塞式IO(Blocking IO)下，传统的java socket监听解决方案是为每一个socket连接建立一个线程，并且在read()调用中阻塞，直到有数据读取进来。这事实上是把每个阻塞的线程当作socket监听器，把java虚拟机的线程调度当作通知机制来使用，很明显这是一种曲线救国的实现路线。毕竟线程的上下文切换还需要消耗额外的资源。所以并不是最高效的实现策略。</p>

<p>真正的就绪选择必须由操作系统来做。操作系统的一项最重要的功能就是处理I/O请求并通知各个线程它们的数据已经准备好了。选择器类提供了这种抽象，使得Java代码能够以可移植的方式，请求底层的操作系统提供就绪选择服务。</p>

<h1 id="核心类">核心类</h1>

<h2 id="selector-1">Selector</h2>

<p><img src="/images/blog/java-nio/05-selector/01-class-selector.png" alt="/images/blog/java-nio/05-selector/01-class-selector.png" /></p>

<h2 id="selectablechannel">SelectableChannel</h2>

<p><img src="/images/blog/java-nio/05-selector/02-class-selectablechannel.png" alt="/images/blog/java-nio/05-selector/02-class-selectablechannel.png" /></p>

<h2 id="selectionkey">SelectionKey</h2>

<p><img src="/images/blog/java-nio/05-selector/03-class-selectionkey.png" alt="/images/blog/java-nio/05-selector/03-class-selectionkey.png" /></p>

<h1 id="使用方法">使用方法</h1>

<h2 id="创建selector">创建Selector</h2>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">Selector</span><span class="o">.</span><span class="na">open</span><span class="o">();</span></code></pre></figure>

<h2 id="向selector注册通道">向Selector注册通道</h2>

<p>当向Selector中注册Channel时，Channel必须是非阻塞的，所以不可以注册FileChannel，因为FileChannel没有实现SelectableChannel接口，不能配置为非阻塞状态模式。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">channel</span><span class="o">.</span><span class="na">configureBlocking</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="n">SelectionKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">selector</span><span class="o">,</span> <span class="n">Selectionkey</span><span class="o">.</span><span class="na">OP_READ</span><span class="o">);</span></code></pre></figure>

<p>当将通道Channel注册到Selector中时，需要在第二个参数中指定相应观察事件的集合<code class="highlighter-rouge">interest集合</code>，即SelectionKey中的几个代表状态的整数。如果想注册多种状态需要用位或(<code class="highlighter-rouge">|</code>)操作符进行连接。</p>

<table>
  <tbody>
    <tr>
      <td>SelectionKey.OP_CONNECT</td>
      <td>连接就绪</td>
    </tr>
    <tr>
      <td>SelectionKey.OP_ACCEPT</td>
      <td>接收就绪</td>
    </tr>
    <tr>
      <td>SelectionKey.OP_READ</td>
      <td>读就绪</td>
    </tr>
    <tr>
      <td>SelectionKey.OP_WRITE</td>
      <td>写就绪</td>
    </tr>
  </tbody>
</table>

<p>可以在注册完Channel到Selector之后，通过获取到的SelectionKey来获取ready集合<code class="highlighter-rouge">key.readyOps();</code>，即可以得到所观察事件是否就绪的一个位或操作之后的值，此时只需要使用相应的interest值与readyOps值取与(&amp;)操作即可确定此事件是否就绪。或者使用JDK提供的四个API(而实际JDK底层代码也是取与操作进行判断的)如下：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">key</span><span class="o">.</span><span class="na">isConnectable</span><span class="o">();</span>
<span class="n">key</span><span class="o">.</span><span class="na">isAcceptable</span><span class="o">();</span>
<span class="n">key</span><span class="o">.</span><span class="na">isReadable</span><span class="o">();</span>
<span class="n">key</span><span class="o">.</span><span class="na">isWritable</span><span class="o">();</span></code></pre></figure>

<p>SelectionKey中还可以添加一些附加对象来标识对应注册的是哪个Channel。方法有两种如下</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Object</span> <span class="n">attach</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
<span class="c1">// 方法1：在注册时候的第三个参数指定</span>
<span class="n">SelectionKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">selector</span><span class="o">,</span> <span class="n">SelectionKey</span><span class="o">.</span><span class="na">OP_ACCEPT</span><span class="o">,</span> <span class="n">attach</span><span class="o">);</span>
<span class="c1">// 方法2：使用attach()方法指定</span>
<span class="n">key</span><span class="o">.</span><span class="na">attach</span><span class="o">(</span><span class="n">attach</span><span class="o">);</span>

<span class="c1">//获取附加对象的方法</span>
<span class="n">Object</span> <span class="n">attached</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">attachment</span><span class="o">();</span></code></pre></figure>

<h2 id="选择通道">选择通道</h2>

<p>当向Selector中注册了通道，就可以调用select来获取有多少通道发生了我们所感兴趣的(interest集合)事件和。该方法及其重载返回的int值表示有多少通道已经就绪。亦即，自上次调用select()方法后有多少通道变成就绪状态。如果调用select()方法，因为有一个通道变成就绪状态，返回了1，若再次调用select()方法，如果另一个通道就绪了，它会再次返回1。如果对第一个就绪的channel没有做任何操作，现在就有两个就绪的通道，但在每次select()方法调用之间，只有一个通道就绪了。</p>

<p>一旦select()方法返回非零，就可以通过<code class="highlighter-rouge">selector.selectedKeys()</code>方法获得所有的以选择即已就绪SelectionKey，通过遍历获取到是SelectionKey的哪个事件就绪。注意每次迭代末尾的keyIterator.remove()调用。Selector不会自己从已选择键集中移除SelectionKey实例。必须在处理完通道时自己移除。下次该通道变成就绪时，Selector会再次将其放入已选择键集中。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// 阻塞到至少有一个通道在你注册的事件上就绪了。</span>
<span class="n">selector</span><span class="o">.</span><span class="na">select</span><span class="o">();</span>
<span class="c1">// 和select()一样，除了最长会阻塞timeout毫秒(参数)。</span>
<span class="n">selector</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
<span class="c1">// 不会阻塞，不管什么通道就绪都立刻返回，如果无通道就绪，则立即返回零</span>
<span class="n">selector</span><span class="o">.</span><span class="na">selectNow</span><span class="o">();</span>

<span class="c1">// 遍历就绪的SelectionKey</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="n">SelectionKey</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="na">selectedKeys</span><span class="o">();</span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">SelectionKey</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
<span class="k">while</span> <span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
	<span class="n">SelectionKey</span> <span class="n">selectedKey</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isAcceptable</span><span class="o">())</span> <span class="o">{</span>
		<span class="c1">// a connection was accepted by a ServerSocketChannel.</span>
	<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isConnectable</span><span class="o">())</span> <span class="o">{</span>
		<span class="c1">// a connection was established with a remote server.</span>
	<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isReadable</span><span class="o">())</span> <span class="o">{</span>
		<span class="c1">// a channel is ready for reading</span>
	<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isWritable</span><span class="o">())</span> <span class="o">{</span>
		<span class="c1">// a channel is ready for writing</span>
	<span class="o">}</span>
	<span class="n">iterator</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

<h2 id="唤醒selector">唤醒Selector</h2>

<p>某个线程调用select()方法后阻塞了，即使没有通道已经就绪，也有办法让其从select()方法返回。只要让其它线程在第一个线程调用select()方法的那个对象上调用Selector.wakeup()方法即可。阻塞在select()方法上的线程会立马返回。</p>

<p>如果有其它线程调用了wakeup()方法，但当前没有线程阻塞在select()方法上，下个调用select()方法的线程会立即“醒来（wake up）”。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">selector</span><span class="o">.</span><span class="na">wakeup</span><span class="o">();</span></code></pre></figure>

<h2 id="关闭selector">关闭Selector</h2>

<p>用完Selector后调用其close()方法会关闭该Selector，且使注册到该Selector上的所有SelectionKey实例无效。通道本身并不会关闭。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">selector</span><span class="o">.</span><span class="na">close</span><span class="o">();</span></code></pre></figure>

<h1 id="example">Example</h1>

<h2 id="selectorservertest">SelectorServerTest</h2>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">freud</span><span class="o">.</span><span class="na">nio</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.ByteBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.SelectionKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.Selector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.ServerSocketChannel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.SocketChannel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.text.MessageFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.text.SimpleDateFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>

<span class="cm">/**
 * @author Freud
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SelectorServerTest</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

		<span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">ServerSocketChannel</span> <span class="n">serverChannel</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// 创建Selector</span>
			<span class="n">selector</span> <span class="o">=</span> <span class="n">Selector</span><span class="o">.</span><span class="na">open</span><span class="o">();</span>

			<span class="c1">// 创建非阻塞Server Socket Channel</span>
			<span class="n">serverChannel</span> <span class="o">=</span> <span class="n">ServerSocketChannel</span><span class="o">.</span><span class="na">open</span><span class="o">();</span>
			<span class="n">serverChannel</span><span class="o">.</span><span class="na">configureBlocking</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
			<span class="n">serverChannel</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="k">new</span> <span class="n">InetSocketAddress</span><span class="o">(</span><span class="mi">7994</span><span class="o">));</span>

			<span class="c1">// 将ServerSocketChannel注册到Selector</span>
			<span class="n">serverChannel</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">selector</span><span class="o">,</span> <span class="n">SelectionKey</span><span class="o">.</span><span class="na">OP_ACCEPT</span><span class="o">);</span>

			<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// 等待信道超时，超时事件为1秒</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="mi">3000</span><span class="o">)</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"等待中..."</span><span class="o">);</span>
					<span class="k">continue</span><span class="o">;</span>
				<span class="o">}</span>

				<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">SelectionKey</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="na">selectedKeys</span><span class="o">()</span>
						<span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
				<span class="k">while</span> <span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
					<span class="n">SelectionKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
					<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isConnectable</span><span class="o">())</span> <span class="o">{</span>
						<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Connecable."</span><span class="o">);</span>
					<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isAcceptable</span><span class="o">())</span> <span class="o">{</span>
						<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Acceptedable."</span><span class="o">);</span>
						<span class="n">handleAccept</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
					<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isReadable</span><span class="o">())</span> <span class="o">{</span>
						<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Readable."</span><span class="o">);</span>
						<span class="n">handleRead</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
					<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isValid</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">isWritable</span><span class="o">())</span> <span class="o">{</span>
						<span class="c1">// Do nothing</span>
						<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Writeable."</span><span class="o">);</span>
						<span class="n">handleWrite</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="n">iterator</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">serverChannel</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">serverChannel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">selector</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">selector</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">handleAccept</span><span class="o">(</span><span class="n">SelectionKey</span> <span class="n">key</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
		<span class="c1">// 接受客户端建立连接的请求</span>
		<span class="n">SocketChannel</span> <span class="n">clientChannel</span> <span class="o">=</span> <span class="o">((</span><span class="n">ServerSocketChannel</span><span class="o">)</span> <span class="n">key</span><span class="o">.</span><span class="na">channel</span><span class="o">())</span>
				<span class="o">.</span><span class="na">accept</span><span class="o">();</span>
		<span class="c1">// 非阻塞式</span>
		<span class="n">clientChannel</span><span class="o">.</span><span class="na">configureBlocking</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
		<span class="c1">// 注册到selector</span>
		<span class="n">clientChannel</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">selector</span><span class="o">(),</span> <span class="n">SelectionKey</span><span class="o">.</span><span class="na">OP_READ</span><span class="o">,</span>
				<span class="n">ByteBuffer</span><span class="o">.</span><span class="na">allocate</span><span class="o">(</span><span class="mi">1024</span><span class="o">));</span>
		<span class="c1">// clientChannel.register(key.selector(), SelectionKey.OP_READ</span>
		<span class="c1">// | SelectionKey.OP_WRITE, ByteBuffer.allocate(1024));</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">handleRead</span><span class="o">(</span><span class="n">SelectionKey</span> <span class="n">key</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
		<span class="c1">// 获得与客户端通信的信道</span>
		<span class="n">SocketChannel</span> <span class="n">clientChannel</span> <span class="o">=</span> <span class="o">(</span><span class="n">SocketChannel</span><span class="o">)</span> <span class="n">key</span><span class="o">.</span><span class="na">channel</span><span class="o">();</span>
		<span class="c1">// 得到并清空缓冲区</span>
		<span class="n">ByteBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="o">(</span><span class="n">ByteBuffer</span><span class="o">)</span> <span class="n">key</span><span class="o">.</span><span class="na">attachment</span><span class="o">();</span>
		<span class="n">buffer</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">clientChannel</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">buffer</span><span class="o">.</span><span class="na">flip</span><span class="o">();</span>
			<span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">buffer</span><span class="o">.</span><span class="na">limit</span><span class="o">()];</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">buffer</span><span class="o">.</span><span class="na">hasRemaining</span><span class="o">())</span> <span class="o">{</span>
				<span class="n">bytes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
				<span class="n">i</span><span class="o">++;</span>
			<span class="o">}</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">MessageFormat</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"接收到来自[{0}]的消息[{1}]"</span><span class="o">,</span>
					<span class="n">clientChannel</span><span class="o">.</span><span class="na">getRemoteAddress</span><span class="o">(),</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">bytes</span><span class="o">)));</span>
			<span class="n">buffer</span> <span class="o">=</span> <span class="n">ByteBuffer</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="n">MessageFormat</span><span class="o">.</span><span class="na">format</span><span class="o">(</span>
					<span class="s">"你好,客户端. @[{0}]，已经收到你的信息[{1}]"</span><span class="o">,</span>
					<span class="k">new</span> <span class="nf">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">)</span>
							<span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">()),</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">bytes</span><span class="o">)).</span><span class="na">getBytes</span><span class="o">());</span>
			<span class="n">clientChannel</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buffer</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
			<span class="c1">// 没有读取到内容的情况</span>
			<span class="n">clientChannel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">handleWrite</span><span class="o">(</span><span class="n">SelectionKey</span> <span class="n">key</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h2 id="selectorclienttest">SelectorClientTest</h2>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">freud</span><span class="o">.</span><span class="na">nio</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.InetSocketAddress</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.ByteBuffer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.SelectionKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.Selector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.channels.SocketChannel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.text.MessageFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

<span class="cm">/**
 * @author Freud
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SelectorClientTest</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Selector</span> <span class="n">selector</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">SelectorClientTest</span><span class="o">(</span><span class="n">Selector</span> <span class="n">selector</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">selector</span> <span class="o">=</span> <span class="n">selector</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// select()方法只能使用一次，用了之后就会自动删除,每个连接到服务器的选择器都是独立的</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">select</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">SelectionKey</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="na">selectedKeys</span><span class="o">()</span>
						<span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
				<span class="k">while</span> <span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
					<span class="n">SelectionKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
					<span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">isReadable</span><span class="o">())</span> <span class="o">{</span>
						<span class="n">SocketChannel</span> <span class="n">channel</span> <span class="o">=</span> <span class="o">(</span><span class="n">SocketChannel</span><span class="o">)</span> <span class="n">key</span><span class="o">.</span><span class="na">channel</span><span class="o">();</span>
						<span class="n">ByteBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="n">ByteBuffer</span><span class="o">.</span><span class="na">allocate</span><span class="o">(</span><span class="mi">1024</span><span class="o">);</span>
						<span class="k">if</span> <span class="o">(</span><span class="n">channel</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
							<span class="n">buffer</span><span class="o">.</span><span class="na">flip</span><span class="o">();</span>
							<span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">buffer</span><span class="o">.</span><span class="na">limit</span><span class="o">()];</span>
							<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
							<span class="k">while</span> <span class="o">(</span><span class="n">buffer</span><span class="o">.</span><span class="na">hasRemaining</span><span class="o">())</span> <span class="o">{</span>
								<span class="n">bytes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
								<span class="n">i</span><span class="o">++;</span>
							<span class="o">}</span>
							<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">MessageFormat</span>
									<span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Server返回Response为[{0}]"</span><span class="o">,</span>
											<span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">bytes</span><span class="o">)));</span>
						<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
							<span class="n">channel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
						<span class="o">}</span>
					<span class="o">}</span>
					<span class="n">iterator</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>

	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
		<span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">SocketChannel</span> <span class="n">channel</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">// 创建Selector</span>
			<span class="n">selector</span> <span class="o">=</span> <span class="n">Selector</span><span class="o">.</span><span class="na">open</span><span class="o">();</span>
			<span class="c1">// 创建非阻塞Socket Channel</span>
			<span class="n">channel</span> <span class="o">=</span> <span class="n">SocketChannel</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">new</span> <span class="n">InetSocketAddress</span><span class="o">(</span><span class="s">"127.0.0.1"</span><span class="o">,</span>
					<span class="mi">7994</span><span class="o">));</span>
			<span class="n">channel</span><span class="o">.</span><span class="na">configureBlocking</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
			<span class="c1">// channel.connect();</span>

			<span class="n">channel</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">selector</span><span class="o">,</span> <span class="n">SelectionKey</span><span class="o">.</span><span class="na">OP_READ</span>
					<span class="o">|</span> <span class="n">SelectionKey</span><span class="o">.</span><span class="na">OP_WRITE</span><span class="o">);</span>

			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Connection setting up."</span><span class="o">);</span>
			<span class="k">while</span> <span class="o">(!</span><span class="n">channel</span><span class="o">.</span><span class="na">isConnected</span><span class="o">())</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"."</span><span class="o">);</span>
				<span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
			<span class="o">}</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>

			<span class="n">channel</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">ByteBuffer</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="s">"Client startup.."</span><span class="o">.</span><span class="na">getBytes</span><span class="o">()));</span>

			<span class="c1">// 监听Selector的各种事件</span>
			<span class="n">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">submit</span><span class="o">(</span>
					<span class="k">new</span> <span class="nf">SelectorClientTest</span><span class="o">(</span><span class="n">selector</span><span class="o">));</span>

			<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// 控制台输入信息发送给Server</span>
				<span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
				<span class="n">channel</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">ByteBuffer</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">next</span><span class="o">().</span><span class="na">getBytes</span><span class="o">()));</span>
			<span class="o">}</span>

		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">scanner</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">scanner</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">channel</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">channel</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">selector</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">selector</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h2 id="server端测试输出">Server端测试输出</h2>

<figure class="highlight"><pre><code class="language-text" data-lang="text">等待中...
等待中...
Acceptedable.
Readable.
接收到来自[/127.0.0.1:52836]的消息[Client startup..]
等待中...
Readable.
接收到来自[/127.0.0.1:52836]的消息[echo1]
等待中...
Readable.
接收到来自[/127.0.0.1:52836]的消息[echo2]
Readable.
接收到来自[/127.0.0.1:52836]的消息[echo3]
Readable.
接收到来自[/127.0.0.1:52836]的消息[echo4]
Readable.</code></pre></figure>

<h2 id="client端测试输入与输出">Client端测试输入与输出</h2>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Connection setting up.
Server返回Response为[你好,客户端. @[2017-04-21 18:00:24]，已经收到你的信息[Client startup..]]
echo1
Server返回Response为[你好,客户端. @[2017-04-21 18:00:27]，已经收到你的信息[echo1]]
echo2
Server返回Response为[你好,客户端. @[2017-04-21 18:00:30]，已经收到你的信息[echo2]]
echo3
Server返回Response为[你好,客户端. @[2017-04-21 18:00:32]，已经收到你的信息[echo3]]
echo4
Server返回Response为[你好,客户端. @[2017-04-21 18:00:35]，已经收到你的信息[echo4]]</code></pre></figure>

<h1 id="参考资料">参考资料</h1>

<p>JAVA-NIO(英文版) - Ron Hitchens</p>

<p>JAVA-NIO(中文版) - Ron Hitchens(著) 裴小星(译)</p>

<p>Java nio tutorial : <a href="http://tutorials.jenkov.com/java-nio/index.html">http://tutorials.jenkov.com/java-nio/index.html</a></p>

<p>并发编程网：Java NIO系列教程-中文翻译版 : <a href="http://ifeve.com/overview/">http://ifeve.com/overview/</a></p>

            </article>
        </div>
      </div>
      <div class="panel docs-content">
        <article class="post-content">
          <div class="wrapper">
             
          </div>
        </article>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2017 <a href=""><code>ghb</code></a>.</p>
		<p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, themed from <a href="http://lesscss.cn/">Less</a></p>
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/lessismore.js"></script>
<script src="/styles/js/application.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  </body>
</html>
